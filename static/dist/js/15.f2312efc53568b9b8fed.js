webpackJsonp([15],{DztI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),o=a.n(i),n=a("exGp"),s=a.n(n),r=a("Dd8w"),l=a.n(r),c={props:{systemForm:{type:Object,default:{}}},data:function(){return{form:{name:"",description:""},rules:{name:[{required:!0,message:"系统类别名称不能为空",trigger:"blur"}],description:[{required:!0,message:"描述不能为空",trigger:"blur"}]}}},created:function(){this.form=this.systemForm}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"system"}},[a("bk-form",{ref:"form",attrs:{"label-width":120,rules:t.rules,model:t.form}},[a("bk-form-item",{attrs:{label:"系统类别名称","error-display-type":"normal",required:!0,property:"name"}},[a("bk-input",{attrs:{placeholder:"请输入系统类别名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("bk-form-item",{attrs:{label:"描述","error-display-type":"normal",required:!0,property:"description"}},[a("bk-input",{attrs:{placeholder:"请输入描述"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1)],1)},staticRenderFns:[]};var h={components:{system:a("VU/8")(c,d,!1,function(t){a("G6ir")},"data-v-5112ca2b",null).exports},data:function(){return{maxTableHeight:"",loading:!1,auth:{},dialogSetting:{systemDialogShow:!1,dialogLoading:!1,closeIconShow:!0,title:""},systemKey:0,systemForm:{},tableList:[],tableLoading:!1,searchForm:{name:""},pagination:{current:1,count:1,limit:10}}},created:function(){this.handleLoad(),this.auth=this.hasPerm(this.$route.path),this.maxTableHeight=this.$store.state.common.defaultTableHeight-52},methods:{handleConfim:function(){var t=this;this.dialogSetting.dialogLoading=!0,this.$refs.system.$refs.form.validate().then(function(e){"新增系统类别"===t.dialogSetting.title?t.handleAdd():t.handleUpdate()}).catch(function(e){t.$cwMessage("输入有误, 请检查您的输入！","warning"),t.dialogSetting.dialogLoading=!1})},handleAdd:function(){var t=this;this.dialogSetting.closeIconShow=!1,this.$api.category.create(l()({},this.$refs.system.form)).then(function(e){e.result?(t.dialogSetting.systemDialogShow=!1,t.$cwMessage("新增成功!","success"),t.handleLoad()):t.$cwMessage(e.message,"error"),t.dialogSetting.closeIconShow=!0,t.dialogSetting.dialogLoading=!1})},handleUpdate:function(){var t=this;this.dialogSetting.closeIconShow=!1,this.$api.category.update(this.$refs.system.form.id,l()({},this.$refs.system.form)).then(function(e){e.result?(t.dialogSetting.systemDialogShow=!1,t.$cwMessage("修改成功!","success"),t.handleLoad()):t.$cwMessage(e.message,"error"),t.dialogSetting.closeIconShow=!0,t.dialogSetting.dialogLoading=!1})},handleOpenDialog:function(t,e){"add"===t?(this.systemForm={name:"",description:""},this.dialogSetting.title="新增系统类别"):(this.systemForm=l()({},e),this.dialogSetting.title="修改系统类别"),this.systemKey+=1,this.dialogSetting.systemDialogShow=!0},handleDelete:function(t){var e,a=this;this.$bkInfo({type:"primary",title:"确认要删除吗？",confirmLoading:!1,confirmFn:(e=s()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.$api.category.delete(t.id).then(function(t){t.result?(a.$cwMessage("删除成功！","success"),1===a.tableList.length&&1!==a.pagination.current&&(a.pagination.current-=1),a.handleLoad()):a.$cwMessage(t.message,"error")});case 1:case"end":return e.stop()}},e,a)})),function(){return e.apply(this,arguments)})})},handleSearch:function(){this.pagination.current=1,this.handleLoad()},handlePageLimitChange:function(t){this.pagination.current=1,this.pagination.limit=t,this.handleLoad()},handlePageChange:function(t){this.pagination.current=t,this.handleLoad()},handleLoad:function(){var t=this;this.tableLoading=!0,this.$api.category.list(l()({},this.searchForm,{page:this.pagination.current,page_size:this.pagination.limit})).then(function(e){e.result?(t.pagination.count=e.data.count,t.tableList=e.data.items):t.$cwMessage(e.message,"error"),t.tableLoading=!1})}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"systemClassManage"}},[t.auth.create||t.auth.search?a("div",{staticClass:"header"},[t.auth.create?a("div",{staticStyle:{float:"left"}},[a("bk-button",{attrs:{theme:"primary"},on:{click:function(e){return t.handleOpenDialog("add")}}},[t._v("新增系统类别")])],1):t._e(),t._v(" "),t.auth.search?a("div",{staticStyle:{float:"right"}},[a("bk-input",{staticStyle:{width:"240px"},attrs:{clearable:"",width:"240px",placeholder:"请输入系统类别名称","right-icon":"bk-icon icon-search"},on:{"right-icon-click":t.handleSearch,enter:t.handleSearch},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1):t._e()]):t._e(),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("div",{staticClass:"content"},[a("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"table",attrs:{data:t.tableList,pagination:t.pagination,"ext-cls":"customTable","max-height":t.maxTableHeight},on:{"page-change":t.handlePageChange,"page-limit-change":t.handlePageLimitChange}},[a("bk-table-column",{attrs:{label:"系统类别名称",prop:"name","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"创建人",prop:"creator","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"创建时间",prop:"create_time","show-overflow-tooltip":!0,sortable:""}}),t._v(" "),a("bk-table-column",{attrs:{label:"修改时间",prop:"edit_time","show-overflow-tooltip":!0,sortable:""}}),t._v(" "),a("bk-table-column",{attrs:{label:"描述",prop:"description","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.auth.modify?a("bk-button",{staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(a){return t.handleOpenDialog("update",e.row)}}},[t._v("修改")]):t._e(),t._v(" "),t.auth.del?a("bk-button",{staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]}}])})],1)],1),t._v(" "),a("bk-dialog",{attrs:{theme:"primary","mask-close":!1,"header-position":"left",title:t.dialogSetting.title,"show-footer":!0,position:{top:50},draggable:!1,width:"600",loading:t.dialogSetting.dialogLoading,"close-icon":t.dialogSetting.closeIconShow},on:{confirm:t.handleConfim},model:{value:t.dialogSetting.systemDialogShow,callback:function(e){t.$set(t.dialogSetting,"systemDialogShow",e)},expression:"dialogSetting.systemDialogShow"}},[a("system",{key:t.systemKey,ref:"system",attrs:{"system-form":t.systemForm}})],1)],1)},staticRenderFns:[]};var m=a("VU/8")(h,g,!1,function(t){a("uVZ+")},"data-v-7bc2374b",null);e.default=m.exports},G6ir:function(t,e){},"uVZ+":function(t,e){}});