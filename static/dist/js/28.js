webpackJsonp([28],{"UwY/":function(t,e){},nYwf:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("NYxO"),r={data:function(){return{maxTableHeight:"",auth:{},tableList:[],tableLoading:!1,isDropdownShow:!1,stateList:[{id:5,name:"success",label:"成功"},{id:7,name:"cancel",label:"取消"}],searchFrom:{name:"",creatTime:["",""],state:""},pagination:{current:1,count:1,limit:10}}},computed:Object(o.b)(["jobFlowHistorySearchForm"]),created:function(){this.auth=this.hasPerm(this.$route.path),this.maxTableHeight=this.$store.state.common.defaultTableHeight-143,this.initSearch(),this.handleLoad()},methods:{handleCheckDetail:function(t){this.$router.push({path:"/jobflowdetail",query:{id:t.id}})},handleCheckJob:function(t){this.$store.commit("changeTabActive","jobviewhistory"),this.$router.push({path:"/jobviewhistory",query:{job_flow_id:t.id}})},handleCreatTimeChange:function(t){this.searchFrom.creatTime=t},initSearch:function(){var t=this.jobFlowHistorySearchForm;t.hasOwnProperty("name")&&(this.searchFrom.name=t.name),t.hasOwnProperty("creatTime")&&(this.searchFrom.creatTime[0]=t.creatTime[0],this.searchFrom.creatTime[1]=t.creatTime[1]),t.hasOwnProperty("state")&&(this.searchFrom.state=t.state)},handleLoad:function(){var t=this;this.tableLoading=!0;var e={name:this.searchFrom.name,eta_gte:this.searchFrom.creatTime[0],eta_lte:this.searchFrom.creatTime[1],state:this.searchFrom.state,process_id:this.$route.query.hasOwnProperty("job_flow_id")?this.$route.query.job_flow_id:"",page:this.pagination.current,page_size:this.pagination.limit};this.$api.processHistory.list(e).then(function(e){e.result?(t.pagination.count=e.data.count,t.tableList=e.data.items):t.$cwMessage(e.message,"error"),t.tableLoading=!1})},handlePageLimitChange:function(t){this.pagination.current=1,this.pagination.limit=t,this.handleLoad()},handlePageChange:function(t){this.pagination.current=t,this.handleLoad()},handleReset:function(){this.searchFrom={name:"",creatTime:["",""],state:""}},handleSearch:function(){this.$store.commit("getJobFlowHistorySearch",this.searchFrom),this.pagination.current=1,this.handleLoad()},handleOpenSeniorSearch:function(){this.isDropdownShow=!this.isDropdownShow}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"jobFlowViewHistory"}},[t.auth.search?a("div",{staticClass:"header"},[a("div",{staticStyle:{float:"left"}},[a("bk-input",{staticStyle:{width:"240px","margin-right":"8px"},attrs:{clearable:"",width:"240px",placeholder:"请输入作业名称","right-icon":"bk-icon icon-search"},on:{"right-icon-click":t.handleSearch,enter:t.handleSearch},model:{value:t.searchFrom.name,callback:function(e){t.$set(t.searchFrom,"name",e)},expression:"searchFrom.name"}}),t._v(" "),a("bk-button",{attrs:{slot:"dropdown-trigger",theme:!0===t.isDropdownShow?"primary":"default","icon-right":!0===t.isDropdownShow?"angle-double-up":"angle-double-down"},on:{click:t.handleOpenSeniorSearch},slot:"dropdown-trigger"},[t._v("高级搜索")])],1),t._v(" "),t.isDropdownShow?a("div",{staticClass:"senior-search-box"},[a("bk-container",{attrs:{margin:0}},[a("bk-form",{attrs:{"label-width":120}},[a("bk-row",[a("bk-col",{attrs:{span:6}},[a("bk-form-item",{attrs:{label:"作业流名:"}},[a("bk-input",{attrs:{placeholder:"请输入作业流名称",clearable:""},model:{value:t.searchFrom.name,callback:function(e){t.$set(t.searchFrom,"name",e)},expression:"searchFrom.name"}})],1)],1),t._v(" "),a("bk-col",{attrs:{span:8}},[a("bk-form-item",{attrs:{label:"计划开始时间:"}},[a("bk-date-picker",{staticStyle:{width:"100%"},attrs:{value:t.searchFrom.creatTime,placeholder:"选择日期时间范围",type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",transfer:!0},on:{change:t.handleCreatTimeChange}})],1)],1),t._v(" "),a("bk-col",{attrs:{span:6}},[a("bk-form-item",{attrs:{label:"状态:"}},[a("bk-select",{staticClass:"header-select",staticStyle:{"background-color":"#fff"},attrs:{clearable:!0},model:{value:t.searchFrom.state,callback:function(e){t.$set(t.searchFrom,"state",e)},expression:"searchFrom.state"}},t._l(t.stateList,function(t,e){return a("bk-option",{key:e,attrs:{id:t.name,name:t.label}})}),1)],1)],1)],1),t._v(" "),a("bk-row",{staticStyle:{display:"flex","justify-content":"center","margin-top":"16px"}},[a("bk-button",{attrs:{theme:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),a("bk-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleReset}},[t._v("重置")]),t._v(" "),a("bk-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleOpenSeniorSearch}},[t._v("取消")])],1)],1)],1)],1):t._e()]):t._e(),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("div",{staticClass:"content"},[a("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"table",attrs:{data:t.tableList,pagination:t.pagination,"ext-cls":"customTable","max-height":t.maxTableHeight},on:{"page-change":t.handlePageChange,"page-limit-change":t.handlePageLimitChange}},[a("bk-table-column",{attrs:{label:"作业流名",prop:"name","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#3a84ff",cursor:"pointer"},on:{click:function(a){return t.handleCheckDetail(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:"跑批系统",prop:"category_name","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"状态",prop:"state"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.stateList[t.stateList.findIndex(function(t){return t.name===e.row.state})].label))])]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:"作业总数",prop:"total_job_count","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"未成功作业数",prop:"total_not_execute_job_count","show-overflow-tooltip":!0}}),t._v(" "),a("bk-table-column",{attrs:{label:"是否释放依赖",prop:"is_release_dependency","show-overflow-tooltip":!0,sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[!1===e.row.is_release_dependency?a("span",[t._v("否")]):t._e(),t._v(" "),!0===e.row.is_release_dependency?a("span",[t._v("是")]):t._e()]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:"计划开始时间",prop:"eta","show-overflow-tooltip":!0,sortable:""}}),t._v(" "),a("bk-table-column",{attrs:{label:"实际开始时间",prop:"start_time","show-overflow-tooltip":!0,sortable:""}}),t._v(" "),a("bk-table-column",{attrs:{label:"完成时间",prop:"end_time","show-overflow-tooltip":!0,sortable:""}}),t._v(" "),a("bk-table-column",{attrs:{label:"作业流情况",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("bk-button",{attrs:{theme:"primary",text:""},on:{click:function(a){return t.handleCheckJob(e.row)}}},[t._v("查看作业")])]}}])})],1)],1)])},staticRenderFns:[]};var i=a("VU/8")(r,n,!1,function(t){a("UwY/")},"data-v-47e7ed2c",null);e.default=i.exports}});