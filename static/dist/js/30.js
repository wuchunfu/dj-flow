webpackJsonp([30],{X1rZ:function(e,a){},b01C:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"log"}},[e.auth.search?t("div",{staticClass:"header"},[t("div",{staticClass:"search-item",staticStyle:{width:"15%"}},[t("span",{staticStyle:{display:"inline-block","flex-basis":"50px"}},[e._v("操作者")]),e._v(" "),t("bk-input",{staticStyle:{flex:"1","margin-right":"16px"},attrs:{clearable:!0,placeholder:"操作者",title:e.searchForm.user},model:{value:e.searchForm.user,callback:function(a){e.$set(e.searchForm,"user",a)},expression:"searchForm.user"}})],1),e._v(" "),t("div",{staticClass:"search-item",staticStyle:{width:"17%"}},[t("span",{staticStyle:{display:"inline-block","flex-basis":"60px"}},[e._v("操作对象")]),e._v(" "),t("bk-select",{staticClass:"header-select",staticStyle:{"background-color":"#fff",flex:"1","margin-right":"16px"},attrs:{clearable:!0,placeholder:"请选择",title:e.searchForm.object_repr},model:{value:e.searchForm.object_repr,callback:function(a){e.$set(e.searchForm,"object_repr",a)},expression:"searchForm.object_repr"}},e._l(e.objectReprs,function(e,a){return t("bk-option",{key:a,attrs:{id:e.value,name:e.name}})}),1)],1),e._v(" "),t("div",{staticClass:"search-item",staticStyle:{width:"17%"}},[t("span",{staticStyle:{display:"inline-block","flex-basis":"60px"}},[e._v("操作类型")]),e._v(" "),t("bk-select",{staticClass:"header-select",staticStyle:{"background-color":"#fff",flex:"1","margin-right":"16px"},attrs:{clearable:!0,placeholder:"请选择",title:e.searchForm.action_flag},model:{value:e.searchForm.action_flag,callback:function(a){e.$set(e.searchForm,"action_flag",a)},expression:"searchForm.action_flag"}},e._l(e.actionFlags,function(e,a){return t("bk-option",{key:a,attrs:{id:e.value,name:e.name}})}),1)],1),e._v(" "),t("div",{staticClass:"search-item",staticStyle:{width:"24%"}},[t("span",{staticStyle:{display:"inline-block","flex-basis":"60px"}},[e._v("开始时间")]),e._v(" "),t("bk-date-picker",{staticStyle:{flex:"1","margin-right":"16px"},attrs:{value:e.searchForm.eta,placeholder:"选择日期时间",type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",transfer:!0,title:e.searchForm.eta},on:{change:e.handleEtaChange}})],1),e._v(" "),t("div",{staticClass:"search-item",staticStyle:{width:"20%"}},[t("bk-button",{staticStyle:{"margin-right":"8px"},attrs:{theme:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),t("bk-button",{on:{click:e.handleReset}},[e._v("重置")])],1)]):e._e(),e._v(" "),t("div",{staticStyle:{clear:"both"}}),e._v(" "),t("div",{staticClass:"content"},[t("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"table",attrs:{data:e.tableList,pagination:e.pagination,"ext-cls":"customTable","max-height":e.maxTableHeight},on:{"page-change":e.handlePageChange,"page-limit-change":e.handlePageLimitChange}},[t("bk-table-column",{attrs:{label:"操作者",prop:"user","show-overflow-tooltip":!0}}),e._v(" "),t("bk-table-column",{attrs:{label:"操作对象",prop:"object_repr",sortable:""}}),e._v(" "),t("bk-table-column",{attrs:{label:"操作类型",prop:"action_flag",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[0===a.row.action_flag?t("span",[e._v("新增")]):1===a.row.action_flag?t("span",[e._v("修改")]):2===a.row.action_flag?t("span",[e._v("删除")]):e._e()]}}])}),e._v(" "),t("bk-table-column",{attrs:{label:"操作时间",prop:"action_time","show-overflow-tooltip":!0,sortable:""}}),e._v(" "),t("bk-table-column",{attrs:{label:"概要",prop:"change_message","show-overflow-tooltip":!0}})],1)],1)])},staticRenderFns:[]};var s=t("VU/8")({data:function(){return{maxTableHeight:"",auth:{},tableList:[],tableLoading:!1,pagination:{current:1,count:1,limit:10},searchForm:{user:"",object_repr:"",action_flag:"",eta:["",""]},actionFlags:[{name:"新增",value:0},{name:"修改",value:1},{name:"删除",value:2}],objectReprs:[{name:"作业",value:"作业"},{name:"作业流",value:"作业流"},{name:"系统设置",value:"系统设置"},{name:"Agent",value:"Agent"},{name:"变量表",value:"变量表"},{name:"日历",value:"日历"},{name:"系统类别",value:"系统类别"},{name:"用户",value:"用户"}]}},created:function(){this.handleLoad(!0),this.auth=this.hasPerm(this.$route.path),this.maxTableHeight=this.$store.state.common.defaultTableHeight-52},methods:{handleEtaChange:function(e){this.searchForm.eta=e},handleReset:function(){this.searchForm={user:"",object_repr:"",action_flag:"",eta:["",""]}},handleSearch:function(){this.pagination.current=1,this.handleLoad(!1)},handlePageLimitChange:function(e){this.pagination.current=1,this.pagination.limit=e,this.handleLoad(!1)},handlePageChange:function(e){this.pagination.current=e,this.handleLoad(!1)},handleLoad:function(e){var a=this;this.tableLoading=!0,this.$route.query.hasOwnProperty("object_repr")&&e&&(this.searchForm.object_repr=this.$route.query.object_repr),this.$api.auditLog.list({user:this.searchForm.user,action_flag:this.searchForm.action_flag,action_time_gte:this.searchForm.eta[0],action_time_lte:this.searchForm.eta[1],object_repr:this.searchForm.object_repr,page:this.pagination.current,page_size:this.pagination.limit}).then(function(e){e.result?(a.pagination.count=e.data.count,a.tableList=e.data.items):a.$cwMessage(e.message,"error"),a.tableLoading=!1})}}},i,!1,function(e){t("X1rZ")},"data-v-3ab287a5",null);a.default=s.exports}});